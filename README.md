# Vulnerability Management with Nessus

## Objectives:
- To install and deploy Nessus Virtual Scanner Appliance and access it through the Nessus Cloud Platform.
- Execute the vulnerability management lifecycle in a virtualized environment comprising of the following stages: Discovery, Prioritization, Assessment, Reporting, Remediation, and Verification.
- Leverage Nessus to manage vulnerability scanning and address identified vulnerabilities.
- Detect deprecated software on a Windows 8.1 machine, remediate vulnerabilities, and verify the vulnerability doesnâ€™t exist anymore.

## Required Resources:
- VMware
- Windows 8.1
- PC with internet access
- Nessus Essential

### Task 1: Register and Download the Nessus software

a. Visit https://tenable.com/products/nessus/nessus-essentials and sign up with a company email.

b. Click the link in the received mail to download the Nessus file.

c. Install the Nessus file.

d. After installation, you will be provided with a url, visit the url and click `connect via ssl`.

![image](https://i.imgur.com/4UH52rp.png)

### Task 2: Assign a Static IP address to the target host

a. Click start on the Windows machine( target host), go to Control Panel > Network and Sharing Center > ethernet > properties > TCP/IP.

b. Click assign IP manually and enter the IP address, Subnet Mask, and Default Gateway.

![image](https://i.imgur.com/HDDkoPC.png)

### Task 3: Perform Non-authenticated scan

a. On the Nessus Dashboard, click New Scan > Basic Network Scan.

b. Enter a name for the scan, Enter the target host IP address, save and click Launch.

![image](https://i.imgur.com/MccQxhr.png)


### Scan Result
![image](https://i.imgur.com/Ur47DST.png)
![image](https://i.imgur.com/lNOk1il.png)
![image](https://i.imgur.com/ziFrL3o.png)
![image](https://i.imgur.com/HN802ih.png)
![image](https://i.imgur.com/ARXepaT.png)

### Task 4: Perform authenticated scan

Firstly, the Windows machine is prepared for authenticated scan by doing the following:

a. Turn on Remote registry: go to services > remote registry > properties.

b. Change the setting to automatic.
![image](https://i.imgur.com/2sFCQ4k.png)

c. Under services, select the server and change the setting to automatic too.

d. Go to Sharing options and turn on Network discovery, file, and printer discovery.
![image](https://i.imgur.com/PmQhvrr.png)

e. Go to User Account Control Settings, drag it down and click OK.
![image](https://i.imgur.com/zfZWA3i.png)

f. Edit the Windows Registry: Click Start > regedit > HKEY_LOCAL_MACHINE > SOFTWARE > Microsoft > Windows > CurrentVersion > Policies > System.

g. Right-click and select new > DWORD(32-bit) value: set value name to LocalAccountTokenFilterPolicy and set value to 1.
![image](https://i.imgur.com/rP4OFTW.png)

### Task 5: Launch an Authenticated Scan

a. Go back to Nessus Dashboard. Click New Scan > Basic Network Scan.

b. Enter a name for the scan and the target host IP address.

c. Click on Credentials and enter the target host username and password.
![image](https://i.imgur.com/UuaCV1I.png)

d. Save and launch scan.
![image](https://i.imgur.com/EAEnjfL.png)
![image](https://i.imgur.com/GVHdrFO.png)
![image](https://i.imgur.com/NDrB9vr.png)
![image](https://i.imgur.com/Uxe4dLk.png)
![image](https://i.imgur.com/hMgLJOg.png)

## Remediations
![image](https://i.imgur.com/1sSZQmC.png)
![image](https://i.imgur.com/iFoB1Aa.png)
![image](https://i.imgur.com/C9GJf4C.png)

## Conclusion
- Authenticated scans uncovered more vulnerabilities than non-authenticated scans.
